<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <base href="<%=basePath%>">
    <meta charset="UTF-8">
    <title>后台管理</title>
    <link rel="icon" href="../../webIndex/images/webLogo.ico" type="image/x-icon">

    <link th:href="@{../../Houtai/css/style.css}" rel="stylesheet"/>
    <link th:href="@{../../Houtai/css/style2.css}" rel="stylesheet"/>

    <link th:href="@{../../User_Data_Update/css/jiazaitoubu.css}" rel="stylesheet"/>
    <link th:href="@{../../User_Data_Update/css/shangchuan.css}" rel="stylesheet"/>
    <link th:href="@{../../User_Data_Update/css/center.css}" rel="stylesheet"/>
    <link th:href="@{../../Homepage/mycssAndimg/css.css}" rel="stylesheet"/>

    <script th:src="@{https://code.jquery.com/jquery-3.5.1.js}"></script>
<!--    <script th:src="@{../../Homepage/js/jquery.min.js}"></script>-->
    <script th:src="@{../../Homepage/js/sHover.min.js}"></script>
    <script th:src="@{../../adminjs/chaxunjs.js}"></script>

    <script type="text/javascript">
        //显示灰色 jQuery 遮罩层
        function showBg2(className) {
            className="."+className;
            var bh = $("body").height();
            var bw = $("body").width();
            $("#fullbg").css({
                height: bh,
                width: bw,
                display: "block"
            });
            // $("#dialog2").show();
            // $(num).show();

            $(className).show();
        }

        //关闭灰色 jQuery 遮罩
        function closeBg2() {
            $("#fullbg,#dialog2").hide();
        }
    </script>


    <script type="text/javascript">
        //显示灰色 jQuery 遮罩层
        function showUserInfo() {
            $("#li010").show();
            $("#li020").hide();
            $("#li030").hide();
        }
        //关闭灰色 jQuery 遮罩
        function closeUserInfo() {
            $("#li010").hide();
        }
    </script>


    <script type="text/javascript">
        //显示灰色 jQuery 遮罩层
        function showVideoInfo() {
            $("#li020").show();
            $("#li010").hide();
            $("#li030").hide();
        }
        //关闭灰色 jQuery 遮罩
        function closeVideoInfo() {
            $("#li020").hide();
        }
    </script>



    <script type="text/javascript">
        //显示灰色 jQuery 遮罩层
        function showMusicUpload() {
            $("#li030").show();
            $("#li010").hide();
            $("#li020").hide();
        }
        //关闭灰色 jQuery 遮罩
        function closeMusicUpload() {
            $("#li030").hide();
        }
    </script>




</head>
<body>



<div class="header">
    <div class="header03"></div>
    <div class="header01"></div>
    <div class="header02">后台管理</div>

</div>
<div id="sidebar" class="nav-collapse " tabindex="5000" style="overflow: hidden; outline: none;">
    <!-- sidebar menu start-->
    <ul class="sidebar-menu">
        <li class="">
            <a class="" href="index.html">
                <i class="icon_house_alt"></i>
                <span>超级管理员：admin</span>
            </a>
        </li>




        <li class="sub-menu">
            <a href="javascript:showUserInfo();" class="">
                <i class="icon_document_alt"></i>
                <span>用户信息管理</span>
                <span class="menu-arrow arrow_carrot-right"></span>
            </a>
        </li>
        <li class="sub-menu">
            <a href="javascript:showVideoInfo();" class="">
                <i class="icon_desktop"></i>
                <span>音乐信息管理</span>
                <span class="menu-arrow arrow_carrot-right"></span>
            </a>
        </li>
        <li>
            <a class="" href="javascript:showMusicUpload();">
                <i class="icon_genius"></i>
                <span>音乐上传</span>
            </a>
        </li>
        <li>
            <a class="" href="/logout">
                <i class="icon_piechart"></i>
                <span>管理员退出</span>

            </a>

        </li>

    </ul>
</div>





<div class="rrcc" id="RightBox">
        <div class="right" id="li010">
            <div class="right01" style="height: 30px"><img src="../../Houtai/images/04.gif" /> 用户信息查询 &gt; </div>
            <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="3">
                <tr>
                    <td height="100%" valign="top">
                        <div style="overflow:auto;height:100%; width:100%">
                            <table width="100%" border="0" cellpadding="8" cellspacing="0" class="table1">
                                <tr style="height: 40px">
                                    <th align="center"><input type="checkbox" name="checkbox" id="checkbox"></th>
                                    <th align="center">用户ID</th>
                                    <th align="center">用户账号</th>
                                    <th align="center">联系电话</th>
                                    <th align="center">地址</th>
                                    <th align="center">审核状态</th>
                                    <th width="160" align="center">操作</th>
                                </tr>
                                <tr class="eachTable" th:each="list : ${userList}">
                                    <TD align="center"><input type="checkbox" name="checkbox2" id="checkbox2"></TD>
                                    <TD align="center" th:text="${list.userID}"></TD>
                                    <TD align="center" th:text="${list.userName}"></TD>
                                    <TD align="center" th:text="${list.userPhone}"></TD>
                                    <TD align="center" th:text="${list.userAddress}"></TD>
                                    <TD align="center" th:text="${list.userState}"></TD>
                                    <TD width="200px" align="center">
                                        <a th:href="'javascript:showBg2(\''+${list.userName}+'\')'">
                                            <BUTTON style="height:21px; font-size:12px" >查看</BUTTON>
                                        </a>
                                        <a th:href="'ban?userID='+${list.userID}">
                                            <BUTTON style="height:21px; font-size:12px" >禁用</BUTTON>
                                        </a>
                                        <a th:href="'verify?userID='+${list.userID}">
                                            <BUTTON style="height:21px; font-size:12px" >审核</BUTTON>
                                        </a>
                                        <a th:href="'delect?userID='+${list.userID}">
                                            <BUTTON style="height:21px; font-size:12px" >删除</BUTTON>
                                        </a>
                                    </TD>
                                    <div th:class="public_m1" th:classappend="${list.userName}" th:id="dialog2">
                                        <p class="close" style="height: 15px;margin: 0">
                                            <a onclick="closeBg2();" style="cursor: pointer">关闭</a>
                                        </p>

                                        <div class="public_m2">用户全部信息资料</div>
                                        <div class="public_m4">
                                            <p style="height: 40px;">
                                                <em>用户姓名：</em>
                                                <input type="text"
                                                       style="height: 23px; border: 1px solid #eaeaea; width: 240px"
                                                       th:value="${list.userMingzi}">
                                            </p>
                                            <p style="height: 40px;">
                                                <em>用户名：</em>
                                                <input type="text"
                                                       style="height: 23px; border: 1px solid #eaeaea; width: 240px"
                                                       th:value="${list.userName}">
                                            </p>
                                            <p style="height: 40px;">
                                                <em>性别：</em>
                                                <input type="text"
                                                       style="height: 23px; border: 1px solid #eaeaea; width: 240px"
                                                       th:value="${list.usersex}">
                                            </p>
                                            <p style="height: 40px;">
                                                <em>密码：</em>
                                                <input type="text"
                                                       style="height: 23px; border: 1px solid #eaeaea; width: 240px"
                                                       th:value="${list.passWord}">
                                            </p>
                                            <p style="height: 40px;">
                                                <em>地址：</em>
                                                <input type="text"
                                                       style="height: 23px; border: 1px solid #eaeaea; width: 240px"
                                                       th:value="${list.userAddress}">
                                            </p>
                                            <p style="height: 40px;">
                                                <em>邮箱：</em>
                                                <input type="text"
                                                       style="height: 23px; border: 1px solid #eaeaea; width: 240px"
                                                       th:value="${list.userEmial}">
                                            </p>
                                            <p style="height: 40px;">
                                                <em>用户状态：</em>
                                                <input type="text"
                                                       style="height: 23px; border: 1px solid #eaeaea; width: 240px"
                                                       th:value="${list.userState}">
                                            </p>

                                        </div>
                                    </div>


                                </tr>
                            </table>
                        </div>
                    </td>
                </tr>
            </table>
        </div>





    <div class="right" id="li020">
        <div class="right01" style="height: 30px"><img src="../../Houtai/images/04.gif" /> 音乐信息查询 &gt; </div>
        <table width="100%" height="95%" border="0" cellspacing="0" cellpadding="3">
            <tr>
                <td height="100%" valign="top">
                    <div style="overflow:auto;height:100%; width:100%">
                        <table width="100%" border="0" cellpadding="8" cellspacing="0" class="table1">
                            <tr style="height: 40px">
                                <th align="center"><input type="checkbox" name="checkbox" id="checkbox3"></th>
                                <th align="center" style="width: 100px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;">音乐ID</th>
                                <th align="center">歌曲名</th>
                                <th align="center">歌手名</th>
                                <th align="center">时长</th>
                                <th align="center">歌曲分类</th>
                                <th align="center">歌曲风格</th>
                                <th align="center">点击量</th>
                                <th align="center">评论量</th>
                                <th width="100" align="center">操作</th>
                            </tr>
                            <tr class="eachTable" th:each="music : ${musicList}">
                                <TD align="center"><input type="checkbox" name="checkbox2" id="checkbox4"></TD>
                                <TD align="center" th:text="${music.getmusicID()}"></TD>
                                <TD align="center" th:text="${music.getmusicName()}"></TD>
                                <TD align="center" th:text="${music.getSinger()}"></TD>
                                <TD align="center" th:text="${music.getmusicTime()}"></TD>
                                <TD align="center" th:if="${music.getmusicState()=='1'}" th:text="非VIP"></TD>
                                <TD align="center" th:if="${music.getmusicState()=='2'}" th:text="VIP"></TD>
                                <div th:switch = "${music.getmusicCategory()}">
                                    <TD align="center" th:case="1" th:text="韩语"></TD>
                                    <TD align="center" th:case="2" th:text="华语"></TD>
                                    <TD align="center" th:case="3" th:text="欧美"></TD>
                                    <TD align="center" th:case="4" th:text="日语"></TD>
                                    <TD align="center" th:case="5" th:text="粤语"></TD>
                                </div>
                                <TD align="center" th:text="${music.getMusicClick()}"></TD>
                                <TD align="center" th:text="${music.getMusicComment()}"></TD>
                                <TD align="center">
                                    <a th:href="'/music?ID='+${music.getmusicID()}">
                                        <BUTTON style="height:21px; font-size:12px" >查看</BUTTON>

                                    </a>
                                    <a th:href="'delectMusic?musicID='+${music.getmusicID()}">
                                        <BUTTON style="height:21px; font-size:12px" >删除</BUTTON>
                                    </a>
                                </TD>
                            </tr>
                        </table>
                    </div>
                </td>
            </tr>
        </table>
    </div>


    <div class="right" id="li030">
        <div class="right01"><img src="../../Houtai/images/04.gif" /> 音乐上传 &gt; </div>
        <form id="upload_form" style="background-color: white;border: #f6f6f6 1px solid;" enctype="multipart/form-data">

            <div>
                <div><label style="color: black;">请选择音乐文件</label></div>
                <div><input type="file" name="file" id="music" multiple="multiple"/></div>
            </div>
            <div>
                <div><label style="color: black;">请选择音乐封面</label></div>
                <div><input type="file" name="file" id="musicImg"/></div>
            </div>
            <div>
                <div><label style="color: black;">请输入歌曲名</label></div>
                <div><input type="text" name="musicName" id="musicName"/></div>
            </div>

            <div>
                <div><label style="color: black;">请输入歌手名</label></div>
                <div><input type="text" name="singer" id="singer"/></div>
            </div>

            <div>
                <div><label style="color: black;">请选择歌曲分类</label></div>
                <div id="musicCategoryRadioList">
                    <label><input name="musicCategory" type="radio" value="1" checked/>韩语 </label>
                    <label><input name="musicCategory" type="radio" value="2"/>华语 </label>
                    <label><input name="musicCategory" type="radio" value="3"/>欧美 </label>
                    <label><input name="musicCategory" type="radio" value="4"/>日语 </label>
                    <label><input name="musicCategory" type="radio" value="5"/>粤语 </label>
                </div>
                <div><label style="color: black;">请选择是否为付费</label></div>
                <div id="musicStateRadioList">
                    <label><input name="musicState" type="radio" value="1" checked/>普通 </label>
                    <label><input name="musicState" type="radio" value="2"/>VIP </label>
                </div>
            </div>
            <div>
                <input type="button" id="tougao" value="确认"/>
                <input type="button" id="fanhui" value="取消返回"/>
                <input type="button" id="submit" value="立即投稿" disabled="disabled"/>
            </div>
            <!--/*@thymesVar id="MusicUploadFeedback" type="java"*/-->
            <p th:if="${MusicUploadFeedback}" style="text-align: center">
                <span style="color: red" th:text="${MusicUploadFeedback}"></span>
            </p>

            <!--/*@thymesVar id="MusicUploadSuccess" type="java"*/-->
            <p th:if="${MusicUploadSuccess}" style="text-align: center">
                <span style="color: green" th:text="${MusicUploadSuccess}"></span>
            </p>

        </form>



    </div>
</div>

<script type="text/javascript">
    $("#fanhui").click(function () {
        location.href = "../index";
    })

</script>

<script>


    $("#tougao").click(function () {
        //判断视频
        var music = $("#music").val();
        if (music == "") {
            alert("请上传投稿的视频");
            return false;
        } else {
            if (!/\.(mp3)$/.test(music)) {
                alert("音乐格式必须为.MP3格式");
                return false;
            }
            //判断图片
            var musicImg = $("#musicImg").val();
            if (musicImg == "") {
                alert("请选择图片");
                return false;
            } else {
                if (!/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(musicImg)) {
                    alert("图片类型必须是.gif,jpeg,jpg,png中的一种")
                    return false;
                }
            }
            //开始判断输入的内容
            var musicName = $("#musicName").val();
            var singer = $("#singer").val();
            if (musicName == "" || singer == "" || singer == "null" || musicName == "null") {
                alert("请输入歌曲名和歌手名");
                return false;
            }
        }

        $("#tougao").attr('disabled', true); //将button变成不可点击
        $("#submit").attr('disabled', false); //将button变成不可点击
    });


    $("#submit").click(function () {
        var formData = new FormData();
        formData.append("music", $('#music')[0].files[0]);
        formData.append("musicImg", $('#musicImg')[0].files[0]);



        formData.append("musicName", $("#musicName").val());
        formData.append("singer", $("#singer").val());


        var musicCategory = $('#musicCategoryRadioList input[name="musicCategory"]:checked ').val();
        var musicState = $('#musicStateRadioList input[name="musicState"]:checked ').val();
        formData.append("musicCategory", musicCategory);
        formData.append("musicState", musicState);

        $.ajax({
            url: '/uploadMusic',    //这里是我自己项目的URL
            dataType: 'json',
            type: 'post',
            contentType: false, //必须
            processData: false, //必须
            data: formData,
            success: function (data) {
                alert(data)
            }
        });
    })


</script>

</body>
</html>